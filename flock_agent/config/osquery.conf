{
  "options": {
    "config_plugin": "filesystem",
    "logger_plugin": "filesystem",
    "logger_path": "/var/log/osquery",
    "utc": "true"
  },

  "schedule": {
    "os_version": {
      "query": "SELECT name, version, build FROM os_version;",
      "interval": 3600
    },
    "apps": {
      "query": "SELECT name, path, bundle_identifier, bundle_short_version FROM apps;",
      "interval": 3600
    },
    "browser_plugins": {
      "query": "SELECT name, identifier, version, path FROM browser_plugins;",
      "interval": 3600
    },
    "chrome_extensions": {
      "query": "SELECT DISTINCT liu.user, ca.identifier, ca.version FROM chrome_extensions AS ca LEFT JOIN logged_in_users AS liu WHERE ca.uid = (SELECT u.uid FROM users u, logged_in_users liu WHERE liu.user = u.username AND liu.tty = 'console');",
      "interval": 3600
    },
    "firefox_addons": {
      "query": "SELECT DISTINCT liu.user, fa.name, fa.identifier, fa.version, fa.active, fa.disabled FROM firefox_addons AS fa LEFT JOIN logged_in_users AS liu WHERE fa.uid = (SELECT u.uid FROM users u, logged_in_users liu WHERE liu.user = u.username AND liu.tty = 'console');",
      "interval": 3600
    },
    "disk_encryption": {
      "query": "SELECT name, encrypted, type FROM disk_encryption WHERE name='/dev/disk1s1';",
      "interval": 3600
    },
    "launchd": {
      "query": "SELECT path, label, keep_alive, username, program_arguments FROM launchd WHERE label NOT LIKE 'com.apple.%' AND disabled != 1;",
      "interval": 3600
    }
  },

  "decorators": {
    "load": [
      "SELECT uuid AS host_uuid FROM system_info;",
      "SELECT user AS username FROM logged_in_users ORDER BY time DESC LIMIT 1;"
    ]
  }
}
